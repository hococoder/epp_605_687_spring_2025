<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week12/07-UnitTestingExample"/><meta name="twitter:url" content="https://hococoder.com/posts/Week12/07-UnitTestingExample"/><meta name="og:url" content="https://hococoder.com/posts/Week12/07-UnitTestingExample"/><title>Week 12 - Unit Testing Example | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 12 - Unit Testing Example | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 12 - Unit Testing Example | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><script src="../../../../jquery-3.7.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><div class="layout"><div class="header"><div class="headerLayout"><div class="title">Mobile Application Development for the iOS Platform</div><div class="subtitle">Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year</div><div class="weeklayout"><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/About Me">About Me</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/Example App">Example App</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week00/00-Week00Overview">Week 0</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week01/00-Week01Overview">Week 1</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week02/00-Week02Overview">Week 2</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week03/00-Week03Overview">Week 3</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week04/00-Week04Overview">Week 4</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week05/00-Week05Overview">Week 5</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week06/00-Week06Overview">Week 6</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week07/00-Week07Overview">Week 7</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week08/00-Week08Overview">Week 8</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week09/00-Week09Overview">Week 9</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week10/00-Week10Overview">Week 10</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week11/00-Week11Overview">Week 11</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week12/00-Week12Overview">Week 12</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week13/00-Week13Overview">Week 13</a></div></div></div><div class="wrapper"><h1>Week 12 - Unit Testing Example</h1><p style="float: left">Previous:  <A HREF="../../Week12/06-IntroductionToUnitTesting/index.html">Introduction to Unit Testing</A></p><p style="float: right">Next:  <A HREF="../../Week12/08-IntroductionToLogging/index.html">Introduction to Logging</A></p><BR/><BR/><center><iframe src="https://jh.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=1deb2485-8ac9-4803-a620-b1bb011b4e4e&autoplay=false&offerviewer=true&showtitle=true&showbrand=true&captions=false&interactivity=all" height="720" width="1280" style="border: 1px solid #464646;" allowfullscreen allow="autoplay" aria-label="Panopto Embedded Video Player" aria-description="Week0-04-THIRDPARTYTOOLS-Lecture" ></iframe></center><p>An important part of any application development process is testing your code. Luckily Xcode has some built in tools that help with that. First, let’s look at a functional test, and as I’m doing it, I’ll show you some of the testing UI in the Xcode interface.</p><p>Tests have been there all along - if you specify them when creating your project. The EPExampleApp was setup this way, and here I’m showing 2 files - one is the EPExampleAppTests file, and the other is a helper class I made for the purposes of this example.</p><p>As you can see, the XCTestCase parent puts some template code in here for you - the setUp and tearDown methods do exactly what they say - setup and tear down the testing environment. This may involve establishing database connections, opening files, initializing view controllers and so forth. In our case, we don’t need to setup anything since we are calling static method.</p><p>We’ve got a method in our helper called addTwoIntegers, so I’ve made a test method for that called testAddTwoIntegers. This naming convention is important so that Xcode sees it as a viable unit test. Inside that method, I’ve put an XCTAssert call, to check that the result of a call to the addTwoIntegers method is what I expect. Here, I expect 40 + 2 to be 42. If not, I’ll put a string stating what is wrong.</p><pre><code><span class="keyword">func</span> testAddTwoIntegers()
{
  <span class="call">XCTAssert</span>(unitTestView.<span class="call">addTwoIntegers</span>(num1: <span class="number">40</span>, num2: <span class="number">2</span>) == <span class="number">42</span>, <span class="string">"That is not the answer!"</span>)
}
</code></pre><p>You may have noticed in the left gutter of the editor some empty diamonds - these denote recognized test methods by the system, and signify one way of running this particular test. You can also go to the Test Navigator in the left hand pane to see the list of methods you can run, and as you hover over them a play button appears next to the name of the method. Either way works, so let’s run one of those now.</p><p>The code compiles, and the test is run. The green checkmark shows that it passed. Now let’s change our expected result to 43, and run the test again. This time the test fails, and a red x is shown, along with our error message. Let’s put that back to 42 so it runs fine next time.</p><p>We can also run performance tests in Xcode. These tests can be used to determine if the performance of a set of code has changed dramatically from an established baseline, which may indicate some sort of regression in your code.</p><p>I’ve got a method in the helper that finds the sum of all the multiples of 3 or 5 below 1,000,000. To write a test method for this, we can use the measure method of XCTestCase to pass in the block that we want to measure. We can use the built in method from the template for this test, so let’s run the method and see what happens.</p><pre><code><span class="keyword">func</span> testPerformanceExample() <span class="keyword">throws</span> {
  <span class="comment">// This is an example of a performance test case.</span>
  <span class="keyword">self</span>.<span class="call">measure</span> {
    <span class="keyword">self</span>.<span class="property">unitTestView</span>.<span class="call">doSomeLoopedTask</span>()
  }
}
</code></pre><p>In the right hand side of the editor next to the test, we can see the time it took to run. If we click on that and choose show, a popup shows more details on the performance. Performance tests run the code 10 times, and take the average time it takes to run the code. Let’s set this result as our baseline, and go back and try a different technique for the code, and run the test again. This time, our performance is worse.</p><p>The last sort of functional test we’ll look at it one for testing asynchronous code, called an Expectation. I’ve got some code in the testURLConnectionWithExpectation already that downloads some data from a URLSession, and I’ve added some assertions and expectations to see if our code works as expected. I’ve added some assertions to make sure that certain things are true - like the data should not be nil, while the error should be nil. I’m also checking that the response and original URLs match up, that the status code is 200, and that we’re getting back a response of text/html. These are all done with variations of the XCTestAssert method - using NotNil, Nil, or Equal as appropriate. We can also use the XCTFail method if we reach the else block.</p><p>OK, let’s get to expectations. Expectations are called that because you “expect” things to be done in a certain amount of time. I’ve defined an expectation before we setup our url session, and gave it a description - we’re getting the URL. At the end of the completion block, we call the fulfill method on the expect. This marks the expectation as having been met. After our resume call on the task, we invoke waitForExpectation, give it a timeout, and a completion handler. waitForExpectation waits to hear whether the fulfill() method gets invoked on the expectation, and if it doesn’t, the body of the completion handler is invoked.</p><pre><code><span class="keyword">func</span> testAsynchronousURLConnection()
{
  <span class="keyword">let</span> url = <span class="type">URL</span>(string: <span class="string">"https://www.jhuapl.edu/"</span>)!
  <span class="keyword">let</span> expect = <span class="call">expectation</span>(description: <span class="string">"GET</span> \(url)<span class="string">"</span>)
  
  <span class="keyword">let</span> session = <span class="type">URLSession</span>.<span class="property">shared</span>
  
  session.<span class="call">dataTask</span>(with: url, completionHandler: { data, response, error <span class="keyword">in</span>
    
    <span class="call">XCTAssertNotNil</span>(data, <span class="string">"data should not be nil"</span>)
    <span class="call">XCTAssertNil</span>(error, <span class="string">"error should be nil"</span>)
    
    <span class="keyword">if let</span> <span class="type">HTTPResponse</span> = response <span class="keyword">as</span>? <span class="type">HTTPURLResponse</span>,
      <span class="keyword">let</span> responseURL = <span class="type">HTTPResponse</span>.<span class="property">url</span>,
      <span class="keyword">let</span> <span class="type">MIMEType</span> = <span class="type">HTTPResponse</span>.<span class="call">mimeType</span>
    {
      <span class="call">XCTAssertEqual</span>(responseURL.<span class="property">absoluteString</span>, url.<span class="property">absoluteString</span>, <span class="string">"HTTP response URL should be equal to original URL"</span>)
      <span class="call">XCTAssertEqual</span>(<span class="type">HTTPResponse</span>.<span class="property">statusCode</span>, <span class="number">200</span>, <span class="string">"HTTP response status code should be 200"</span>)
      <span class="call">XCTAssertEqual</span>(<span class="type">MIMEType</span>, <span class="string">"text/html"</span>, <span class="string">"HTTP response content type should be text/html"</span>)
    }
    <span class="keyword">else</span>
    {
      <span class="keyword">return</span>
    }
    
    expect.<span class="call">fulfill</span>()
  }).<span class="call">resume</span>()
  
  
  <span class="call">waitForExpectations</span>(timeout: <span class="number">5.0</span>, handler:
    {
      error <span class="keyword">in
      if let</span> error = error
      {
        <span class="call">print</span>(<span class="string">"Error:</span> \(error.<span class="property">localizedDescription</span>)<span class="string">"</span>)
      }
  })
}
</code></pre><p>If we run this test, we can see that indeed, the test passes because we can reach the specified URL. What if I decrease the timeout to 0.1s??</p><p>If I try again now, sure enough, the timeout is exceeded, and an error is thrown. The same would happen if the wireless was turned off and the response from the server lasted longer than your expectation. Tests like this for networking calls can be used to see how your code deals in less than ideal network conditions, and those conditions happen way more often than you think.</p><p style="float: left">Previous:  <A HREF="../../Week12/06-IntroductionToUnitTesting/index.html">Introduction to Unit Testing</A></p><p style="float: right">Next:  <A HREF="../../Week12/08-IntroductionToLogging/index.html">Introduction to Logging</A></p><BR/><BR/></div><leftside><u><p>Week 12</p></u><div class="weekSection"><ul><li><div class="comment-container"><div class="tocItem"><a id="Week 12 Overview" href="../../Week12/00-Week12Overview/index.html">Week 12 Overview</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to Accessibility" href="../../Week12/01-IntroductionToAccessibility/index.html">Introduction to Accessibility</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Accessibility Example" href="../../Week12/02-AccessibilityExample/index.html">Accessibility Example</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to I18N" href="../../Week12/03-IntroductionToI18N/index.html">Introduction to I18N</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="I18N Example" href="../../Week12/04-I18NExample/index.html">I18N Example</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to Instruments" href="../../Week12/05-IntroductionToInstruments/index.html">Introduction to Instruments</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to Unit Testing" href="../../Week12/06-IntroductionToUnitTesting/index.html">Introduction to Unit Testing</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Unit Testing Example" href="../../Week12/07-UnitTestingExample/index.html">Unit Testing Example</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to Logging" href="../../Week12/08-IntroductionToLogging/index.html">Introduction to Logging</a></div></div></li></ul></div></leftside><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated January 25, 2025 at 1:51 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></div></body></html>