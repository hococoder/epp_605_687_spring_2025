<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week08/02-AVKitExample"/><meta name="twitter:url" content="https://hococoder.com/posts/Week08/02-AVKitExample"/><meta name="og:url" content="https://hococoder.com/posts/Week08/02-AVKitExample"/><title>Week 8 - AVKit Example | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 8 - AVKit Example | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 8 - AVKit Example | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_fall_2023/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_fall_2023/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_fall_2023/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_fall_2023/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_fall_2023/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_fall_2023/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_fall_2023/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_fall_2023/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_fall_2023/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_fall_2023/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_fall_2023/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_fall_2023/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_fall_2023/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_fall_2023/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_fall_2023/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_fall_2023/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/epp_605_687_fall_2023/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 8 - AVKit Example</h1><p style="float: left">Previous:  <A HREF="../01-IntroductionToAVKit/index.html">Introduction to AVKit</A></p><p style="float: right">Next:  <A HREF="../03-IntroductionToInAppPurchases/index.html" class="nextModule">Introduction to In App Purchases</A></p><BR/><BR/><h2>Example - Loading a Video</h2><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_rykgp28b?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_rykgp28b&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p class="new"> The video above shows the iOS 13 example below, but the code snippet shows the iOS 14 VideoPlayer view, and is in the EPExampleApp if you want to take a look</p><p>iOS 14 has the luxury of having a new <code>ViewPlayer</code> view built into SwiftUI, and it's really easy to display a video in your view:</p><pre><code><span class="keyword">struct</span> AVKitView: <span class="type">View</span> {
  
    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
      
      <span class="keyword">let</span> url = <span class="type">URL</span>(string: <span class="string">"http://159.203.191.136/8-Week8-Introduction.mp4"</span>)!
      <span class="keyword">let</span> player = <span class="type">AVPlayer</span>(url: url)
      
      <span class="type">VideoPlayer</span>(player: player)
    }
}

</code></pre><p>However, similar to the MapView, this is pretty basic, only giving you the playback and basic controls.</p><p>To do anything else we still need to implement the iOS 13 way of doing things, so we can get features like Picture in Picture. This requires wrapping the <code>AVPlayerViewController</code> in a <code>UIViewControllerRepresentable</code>, similar to the alternate way of getting a MapView (except then we were using a <code>UIViewRepresentable</code>)</p><pre><code><span class="keyword">struct</span> AVKitView2: <span class="type">View</span> {
    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
        <span class="type">AVPlayerView</span>()
    }
}


<span class="keyword">struct</span> AVPlayerView: <span class="type">UIViewControllerRepresentable</span> {
  
  <span class="keyword">func</span> makeUIViewController(context: <span class="type">Context</span>) -&gt; <span class="type">AVPlayerViewController</span> {
    <span class="keyword">let</span> pvc = <span class="type">AVPlayerViewController</span>()
    
    <span class="keyword">let</span> url = <span class="type">URL</span>(string: <span class="string">"http://159.203.191.136/8-Week8-Introduction.mp4"</span>)!
    <span class="keyword">let</span> player = <span class="type">AVPlayer</span>(url: url)
    pvc.<span class="property">player</span> = player
    <span class="keyword">return</span> pvc
  }
  
  <span class="keyword">func</span> updateUIViewController(<span class="keyword">_</span> uiViewController: <span class="type">AVPlayerViewController</span>, context: <span class="type">Context</span>) {}
}

</code></pre><p>The methods that you need to implement are similar to <code>UIViewRepresentable</code>, so this pattern should be familiar to you by now.</p><p>Let's run this in the simulator, both for the iPhone and iPad so we can look at the differences. Both players are almost identical, and pretty full featured - all of the same functionality you see in Apple's built in video players (e.g. in the Apple TV app) are seen here - full screen buttons, scrubbers, play buttons, and time stamp indicators. The key difference between the iPad and the iPhone is that the iPad has an additional icon in the upper left hand corner, which will drop the video down to Picture in Picture mode.<br><br></p><p class="info"> From everything I've read, iOS14 *should* allow the iPhone 12 version also display a Picture in Picture button, but for some reason it does not, even though the functionality is used by many apps</p><p>When Picture in Picture is enabled, I can go back to the home screen, and the video stays in place, floating above the home screen. I can move it to different corners of the screen, and when I'm ready to restore back to the full sized movie, pressing that button will bring the app back to the foreground and put the video back in place. Not bad for about 20 lines of code!</p><p>Note that we didn't have a <code>Coordinator</code> class defined here. All of the delegate methods on the <code>AVPlayerViewControllerDelegate</code> protocol are optional, so unless you <em>want</em> to customize behaviors, such as what happens right before or right after PiP starts (for example), you don't need a Coordinator. If you do though, the code stub looks like this:</p><pre><code><span class="keyword">func</span> makeCoordinator() -&gt; <span class="type">Coordinator</span> {
  <span class="type">Coordinator</span>()
}

<span class="keyword">class</span> Coordinator: <span class="type">NSObject</span>, <span class="type">AVPlayerViewControllerDelegate</span> {

  <span class="keyword">override init</span>() {

  }
  
  <span class="comment">//implements AVPlayerViewControllerDelegate methods here</span>

}
</code></pre><p>As you can see, playing a video in AVKit is pretty easy, and you get all the basic controls for free!</p><p style="float: left">Previous:  <A HREF="../01-IntroductionToAVKit/index.html">Introduction to AVKit</A></p><p style="float: right">Next:  <A HREF="../03-IntroductionToInAppPurchases/index.html" class="nextModule">Introduction to In App Purchases</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated September 10, 2023 at 8:40 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>