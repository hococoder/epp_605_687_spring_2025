<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week09/07-HKWriteData"/><meta name="twitter:url" content="https://hococoder.com/posts/Week09/07-HKWriteData"/><meta name="og:url" content="https://hococoder.com/posts/Week09/07-HKWriteData"/><title>Week 9 - Writing HealthKit Data | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 9 - Writing HealthKit Data | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 9 - Writing HealthKit Data | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><script src="../../../../jquery-3.7.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><div class="layout"><div class="header"><div class="headerLayout"><div class="title">Mobile Application Development for the iOS Platform</div><div class="subtitle">Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year</div><div class="weeklayout"><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/About Me">About Me</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/Example App">Example App</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week00/00-Week00Overview">Week 0</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week01/00-Week01Overview">Week 1</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week02/00-Week02Overview">Week 2</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week03/00-Week03Overview">Week 3</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week04/00-Week04Overview">Week 4</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week05/00-Week05Overview">Week 5</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week06/00-Week06Overview">Week 6</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week07/00-Week07Overview">Week 7</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week08/00-Week08Overview">Week 8</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week09/00-Week09Overview">Week 9</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week10/00-Week10Overview">Week 10</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week11/00-Week11Overview">Week 11</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week12/00-Week12Overview">Week 12</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week13/00-Week13Overview">Week 13</a></div></div></div><div class="wrapper"><h1>Week 9 - Writing HealthKit Data</h1><p style="float: left">Previous:  <A HREF="../../Week09/06-HKStatistics/index.html">HKStatistics</A></p><p style="float: right">Next:  <A HREF="../../Week10/00-Week10Overview/index.html">Week 10 Overview</A></p><BR/><BR/><a name="exampleWritingNewDataToHealthkit"></a>
<h2>Example - Writing New Data to HealthKit</h2><center><iframe id="myIframe" src="https://jh.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=bd81f120-a48e-423d-b865-b1bb0119e2b3&autoplay=false&offerviewer=true&showtitle=true&showbrand=true&captions=false&interactivity=all"  style="border: 1px solid #464646;" allowfullscreen allow="autoplay" aria-label="Panopto Embedded Video Player" aria-description="Week0-04-THIRDPARTYTOOLS-Lecture" ></iframe></center><p>For our last example, let's look at how to add new data to HealthKit. Our weight changes pretty much every day, so having the ability to add new values for that will come in handy. In the <code>HealthKitDataHelper</code> class add the following method to add new weight values:</p><pre><code><span class="keyword">func</span> addNewWeight(<span class="keyword">_</span> weight: <span class="type">Double</span>) {
  
  <span class="keyword">let</span> bodyMassType = <span class="type">HKObjectType</span>.<span class="call">quantityType</span>(forIdentifier: .<span class="dotAccess">bodyMass</span>)!
  <span class="keyword">let</span> weightQuantity = <span class="type">HKQuantity</span>(unit: <span class="type">HKUnit</span>.<span class="call">pound</span>(), doubleValue: weight)
  <span class="keyword">let</span> date = <span class="type">Date</span>()
  <span class="keyword">let</span> bodyMassSample = <span class="type">HKQuantitySample</span>(type: bodyMassType, quantity: weightQuantity, start: date, end: date)
  <span class="type">HKHealthStore</span>().<span class="call">save</span>(bodyMassSample)
  {
    success, error <span class="keyword">in
    if let</span> error = error {
      <span class="call">print</span>(<span class="string">"Error saving weight</span> \(error.<span class="property">localizedDescription</span>)<span class="string">"</span>)
      <span class="keyword">return</span>
    }
    <span class="keyword">self</span>.<span class="call">readWeight</span>()
  }
}
</code></pre><p>Let's break this down:</p><ul><li>We'll be adding a body mass entry, so our <code>HKObjectType</code> uses the <code>.bodyMass</code> identifier.</li><li>The quantity we'll be adding is a certain number of pounds, so <code>HKQuantity</code> can be initialized with a <code>HKUnit.pound()</code> unit, using the weight passed into the function</li><li>We'll use today's date to define a <code>HKQuantitySample</code>, along with the <code>type</code> and <code>quantity</code> defined above.</li><li>Finally, save the new sample to the <code>HKHealthStore</code> instance, checking for errors. If everything is ok, call our <code>readWeight</code> method to update our view.</li></ul><p>To be able to call this in the simulator, add the following to the <code>Form</code> in our view</p><pre><code><span class="type">HStack</span> {
  <span class="type">Spacer</span>()
  <span class="type">TextField</span>(<span class="string">"Enter New Weight"</span>, text: <span class="keyword">self</span>.<span class="property">$newWeight</span>)
  <span class="type">Button</span>(<span class="string">"Add Weight"</span>) {
    <span class="keyword">self</span>.<span class="property">hkData</span>.<span class="call">addNewWeight</span>(<span class="type">Double</span>(<span class="keyword">self</span>.<span class="property">newWeight</span>)!)
    <span class="keyword">self</span>.<span class="property">newWeight</span> = <span class="string">""</span>
  }
  <span class="type">Spacer</span>()
}
</code></pre><p>This will call the <code>addNewWeight</code> function, using the value the user entered in the <code>TextField</code>.</p><p>Run this in the simulator, and try entering a new weight value. The display gets updated, and you can even go into the Health App to check out the full list of weight data, and see that the most recent entry is the one just added.</p><p>Writing data to the health store is just as easy as reading data, assuming you have asked for and received the correct permissions from the user.</p><p>If you have any questions about the examples in this video, please post them in the forums.</p><p style="float: left">Previous:  <A HREF="../../Week09/06-HKStatistics/index.html">HKStatistics</A></p><p style="float: right">Next:  <A HREF="../../Week10/00-Week10Overview/index.html">Week 10 Overview</A></p><BR/><BR/></div><leftside><u><p>Week 9</p></u><div class="weekSection"><ul><li><div class="comment-container"><div class="tocItem"><a id="Week 09 Overview" href="../../Week09/00-Week09Overview/index.html">Week 09 Overview</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to HealthKit" href="../../Week09/01-IntroductionToHealthKit/index.html">Introduction to HealthKit</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="HKEnabling" href="../../Week09/02-HKEnabling/index.html">HKEnabling</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="HKAccess" href="../../Week09/03-HKAccess/index.html">HKAccess</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="HKStaticData" href="../../Week09/04-HKStaticData/index.html">HKStaticData</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="HKQueries" href="../../Week09/05-HKQueries/index.html">HKQueries</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="HKStatistics" href="../../Week09/06-HKStatistics/index.html">HKStatistics</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="HKWriteData" href="../../Week09/07-HKWriteData/index.html">HKWriteData</a></div></div></li></ul></div></leftside><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated January 26, 2025 at 12:00 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></div></body></html>