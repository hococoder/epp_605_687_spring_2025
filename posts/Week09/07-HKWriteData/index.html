<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week09/07-HKWriteData"/><meta name="twitter:url" content="https://hococoder.com/posts/Week09/07-HKWriteData"/><meta name="og:url" content="https://hococoder.com/posts/Week09/07-HKWriteData"/><title>Week 9 - Writing HealthKit Data | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 9 - Writing HealthKit Data | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 9 - Writing HealthKit Data | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_fall_2023/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_fall_2023/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_fall_2023/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_fall_2023/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_fall_2023/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_fall_2023/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_fall_2023/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_fall_2023/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_fall_2023/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_fall_2023/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_fall_2023/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_fall_2023/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_fall_2023/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_fall_2023/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_fall_2023/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_fall_2023/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/epp_605_687_fall_2023/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 9 - Writing HealthKit Data</h1><p style="float: left">Previous:  <A HREF="../06-HKStatistics/index.html">Introduction to HealthKit</A></p><p style="float: right">Next:  <A HREF="../../Week10/00-Week10Overview/index.html">Week 10 Overview</A></p><BR/><BR/><h2>Example - Writing New Data to HealthKit</h2><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_o5jvcani?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_o5jvcani&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p>For our last example, let's look at how to add new data to HealthKit. Our weight changes pretty much every day, so having the ability to add new values for that will come in handy. In the <code>HealthKitDataHelper</code> class add the following method to add new weight values:</p><pre><code><span class="keyword">func</span> addNewWeight(<span class="keyword">_</span> weight: <span class="type">Double</span>) {
  
  <span class="keyword">let</span> bodyMassType = <span class="type">HKObjectType</span>.<span class="call">quantityType</span>(forIdentifier: .<span class="dotAccess">bodyMass</span>)!
  <span class="keyword">let</span> weightQuantity = <span class="type">HKQuantity</span>(unit: <span class="type">HKUnit</span>.<span class="call">pound</span>(), doubleValue: weight)
  <span class="keyword">let</span> date = <span class="type">Date</span>()
  <span class="keyword">let</span> bodyMassSample = <span class="type">HKQuantitySample</span>(type: bodyMassType, quantity: weightQuantity, start: date, end: date)
  <span class="type">HKHealthStore</span>().<span class="call">save</span>(bodyMassSample)
  {
    success, error <span class="keyword">in
    if let</span> error = error {
      <span class="call">print</span>(<span class="string">"Error saving weight</span> \(error.<span class="property">localizedDescription</span>)<span class="string">"</span>)
      <span class="keyword">return</span>
    }
    <span class="keyword">self</span>.<span class="call">readWeight</span>()
  }
}
</code></pre><p>Let's break this down:</p><ul><li>We'll be adding a body mass entry, so our <code>HKObjectType</code> uses the <code>.bodyMass</code> identifier.</li><li>The quantity we'll be adding is a certain number of pounds, so <code>HKQuantity</code> can be initialized with a <code>HKUnit.pound()</code> unit, using the weight passed into the function</li><li>We'll use today's date to define a <code>HKQuantitySample</code>, along with the <code>type</code> and <code>quantity</code> defined above.</li><li>Finally, save the new sample to the <code>HKHealthStore</code> instance, checking for errors. If everything is ok, call our <code>readWeight</code> method to update our view.</li></ul><p>To be able to call this in the simulator, add the following to the <code>Form</code> in our view</p><pre><code><span class="type">HStack</span> {
  <span class="type">Spacer</span>()
  <span class="type">TextField</span>(<span class="string">"Enter New Weight"</span>, text: <span class="keyword">self</span>.<span class="property">$newWeight</span>)
  <span class="type">Button</span>(<span class="string">"Add Weight"</span>) {
    <span class="keyword">self</span>.<span class="property">hkData</span>.<span class="call">addNewWeight</span>(<span class="type">Double</span>(<span class="keyword">self</span>.<span class="property">newWeight</span>)!)
    <span class="keyword">self</span>.<span class="property">newWeight</span> = <span class="string">""</span>
  }
  <span class="type">Spacer</span>()
}
</code></pre><p>This will call the <code>addNewWeight</code> function, using the value the user entered in the <code>TextField</code>.</p><p>Run this in the simulator, and try entering a new weight value. The display gets updated, and you can even go into the Health App to check out the full list of weight data, and see that the most recent entry is the one just added.</p><p>Writing data to the health store is just as easy as reading data, assuming you have asked for and received the correct permissions from the user.</p><p>If you have any questions about the examples in this video, please post them in the forums.</p><p style="float: left">Previous:  <A HREF="../06-HKStatistics/index.html">Introduction to HealthKit</A></p><p style="float: right">Next:  <A HREF="../../Week10/00-Week10Overview/index.html">Week 10 Overview</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated August 27, 2023 at 5:26 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>