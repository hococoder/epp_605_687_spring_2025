<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week09/01-IntroductionToHealthKit"/><meta name="twitter:url" content="https://hococoder.com/posts/Week09/01-IntroductionToHealthKit"/><meta name="og:url" content="https://hococoder.com/posts/Week09/01-IntroductionToHealthKit"/><title>Week 9 - Introduction to HealthKit | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 9 - Introduction to HealthKit | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 9 - Introduction to HealthKit | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_fall_2023/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_fall_2023/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_fall_2023/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_fall_2023/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_fall_2023/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_fall_2023/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_fall_2023/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_fall_2023/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_fall_2023/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_fall_2023/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_fall_2023/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_fall_2023/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_fall_2023/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_fall_2023/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_fall_2023/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_fall_2023/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/epp_605_687_fall_2023/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 9 - Introduction to HealthKit</h1><p style="float: left">Previous:  <A HREF="../00-Week09Overview/index.html">Week 9 Overview</A></p><p style="float: right">Next:  <A HREF="../02-HKEnabling/index.html" class="nextModule">Enabling HealthKit</A></p><BR/><BR/><h2>Overview</h2><center>
<p class="suggestedReading">
Suggested Reading: <BR/>
<A HREF="https://developer.apple.com/health-fitness/">HealthKit Landing Page (Apple)</A><BR/>
<A HREF="https://developer.apple.com/documentation/healthkit">HealthKit Documentation</A><BR/>
</p>
</center><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_5j6xu09o?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_5j6xu09o&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p>HealthKit is a framework that allows you to store and share health related data between apps. In addition to getting information from various apps, it can also get data directly from health and fitness devices that use bluetooth low energy (or BTLE), as well as from the M series of motion coprocessors that are in modern iOS devices. One thing to note however is that HealthKit, and the Health App, which provides a view of the data inside HealthKit) are not available on iPad, and they can also not be used within an app extension.</p><h2>HealthKit and Privacy</h2><p>A key feature about HealthKit is centered around privacy. HealthKit data is only stored locally on the device, and when the device is locked, that data becomes encrypted. Apps only have access to the data the user has specified - which data apps can read from and write to are configurable. HealthKit allows for writing to the data store when the device is locked (so you can record the distance you’ve walked for example, while the phone is locked in your pocket), but reading during lock is not allowed. As a developer using HealthKit, you can’t sell any information obtained from HealthKit, nor can you disclose information to a third party without consent. Privacy policies must be provided in your app to satisfy the requirements of HIPAA, the Health Insurance Portability and Accountability Act.</p><p>HealthKit is only available with a paid iOS developer license, so you can’t develop a HealthKit app with the free developer accounts Apple provides. Also HealthKit is one of the most regulated frameworks that Apple offers, since it deals with PHI, or patient health information. If it even looks like you might break a rule laid out in the App Store guidelines concerning HealthKit, you app will probably be rejected.</p><h2>Accessing Health Data</h2><p>The HealthKit API sits on top of a secure storage area on your file system that contains the raw data. There is no other way to access the data in the secure store except by the API included in HealthKit. Apps use those API to write to and read from the data store, as you can see in this image on the slide, but they do not talk to each other directly to exchange information. Some apps may only write data, others may only read, and others may do both.</p><img src="../../../week09/HealthKitLayers.png#centerResizedSlide" alt="HealthKit Layers"/><p>How do you ensure that all of the various HealthKit related apps can not only use the HealthKit API but write and read data that are compatible with every other HealthKit app out there? HealthKit only allows a restricted subset of datatypes to be entered into the secure store, and those types are all immutable - in other words, you can’t make your own health data subtypes. This causes HealthKit app developers to not only obey the same API in terms of method calls, but also the same API in terms of data formats. If you have a unique type of data that you would like to store in your app, you can do it, just not in the HealthKit data store.</p><h2>Setting up HealthKit In Your App</h2><p>From a development standpoint, setting up HealthKit is fairly straightforward.</p><ul><li>First, in Xcode, enable HealthKit as a capability in your app.</li><li>You'll need to fill out the <code>NSHealthUpdateUsageDescription</code> and <code>NSHealthShareUsageDescription</code> keys in the <code>Info.plist</code> file.</li><li>In your code, be sure to check for <code>HKHealthStore.isHealthDataAvailable</code> (remember, HealthKit is not available on iPad).</li><li>If HealthKit is enabled and available, make a <code>HKHealthStore</code> object to access the data store.</li><li>Finally, as with other frameworks dealing with privacy, ask for permission! In this case, you’re asking permission for you app to read or write particular types of data from or to the store. See the example sections to see how this works.</li></ul><img src="../../../week09/EnablingHealthKit.png#centerResizedSlide" alt="HealthKit Layers"/><h2>Saving Data in HealthKit</h2><p>To store data, you need to do the following:</p><ul><li>First, locate the type identifier for the type of data you wish to store, for example <code>sleepAnalysis</code>.</li><li>Next, create an object of matching <code>HKObjectType</code> - in this case, <code>HKCategory</code> type.</li><li>Then, make an object of the matching <code>HKSample</code> class.</li><li>Finally, use the <code>save(_:withCompletion)</code> method to save the data in the store.</li></ul><h2>Performing Queries</h2><p>To perform queries, you have a few different options.</p><ul><li>First, direct calls to the HealthKit store can be used to grab data such as gender, height and weight.</li><li>Queries such as <code>HKSampleQuery</code>, which can take in descriptors and predicates, can return the current snapshot of data in the store</li><li>Long running queries, such as <code>HKObserverQuery</code> can monitor for changes to the data and send notifications to your app in the background.</li></ul><p style="float: left">Previous:  <A HREF="../00-Week09Overview/index.html">Week 9 Overview</A></p><p style="float: right">Next:  <A HREF="../02-HKEnabling/index.html" class="nextModule">Enabling HealthKit</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated October 11, 2023 at 8:12 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>