<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week07/06-Biometrics"/><meta name="twitter:url" content="https://hococoder.com/posts/Week07/06-Biometrics"/><meta name="og:url" content="https://hococoder.com/posts/Week07/06-Biometrics"/><title>Week 10 - Biometrics | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 10 - Biometrics | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 10 - Biometrics | Mobile Application Development for the iOS Platform"/><meta name="description" content="Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year"/><meta name="twitter:description" content="Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year"/><meta name="og:description" content="Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><script src="../../../../jquery-3.7.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><div class="layout"><div class="header"><div class="headerLayout"><div class="title">Mobile Application Development for the iOS Platform</div><div class="subtitle">Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year</div><div class="weeklayout"><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/About Me">About Me</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/Example App">Example App</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week00/00-Week00Overview">Week 0</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week01/00-Week01Overview">Week 1</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week02/00-Week02Overview">Week 2</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week03/00-Week03Overview">Week 3</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week04/00-Week04Overview">Week 4</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week05/00-Week05Overview">Week 5</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week06/00-Week06Overview">Week 6</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week07/00-Week07Overview">Week 7</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week08/00-Week08Overview">Week 8</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week09/00-Week09Overview">Week 9</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week10/00-Week10Overview">Week 10</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week11/00-Week11Overview">Week 11</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week12/00-Week12Overview">Week 12</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week13/00-Week13Overview">Week 13</a></div></div></div><div class="wrapper"><h1>Week 10 - Biometrics</h1><p style="float: left">Previous:  <A HREF="../../Week07/05-NotificationDetailExample/index.html">Notification Detail Example</A></p><p style="float: right">Next:  <A HREF="../../Week08/00-Week08Overview/index.html">Week 08 Overview</A></p><BR/><BR/><a name="overview"></a>
<h2>Overview</h2><center><iframe id="myIframe" src="https://jh.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=42f41a21-66ea-47ab-8b09-b1bb01172314&autoplay=false&offerviewer=true&showtitle=true&showbrand=true&captions=false&interactivity=all"  style="border: 1px solid #464646;" allowfullscreen allow="autoplay" aria-label="Panopto Embedded Video Player" aria-description="Week0-04-THIRDPARTYTOOLS-Lecture" ></iframe></center><p class="new">Unfortunately, starting with Spring of 2021, the University Developer account no longer allows the use of Sign in With Apple, so I have removed that from the course and replaced it with this Biometrics model. If you want to learn more about Sign in With Apple, let me know and I can provide some resources.</p><p>Built into every modern iOS device are some sort of Biometrics - either Touch ID, or Face ID. Those can be used to help you log into not only your phone, but access things like your passwords in iCloud and pay for your purchases with Apple Wallet. Integrating a check for Biometrics is pretty straight forward. Here, we'll focus around Face ID, but the steps are similar for Touch ID based devices. This code can be found in the Week 10 folder of the EPExampleApp.</p><p>Start by defining an enum with our authentication state after importing SwiftUI and LocalAuthentication:</p><pre><code><span class="keyword">import</span> SwiftUI
<span class="keyword">import</span> LocalAuthentication

<span class="keyword">enum</span> AuthenticationState {
    <span class="keyword">case</span> loggedIn, loggedOut
}
</code></pre><p>Then make our SwiftUI view:</p><pre><code><span class="keyword">struct</span> BiometricView: <span class="type">View</span> {

  <span class="keyword">@ObservedObject var</span> authenticator: <span class="type">Authenticator</span> = <span class="type">Authenticator</span>()

  <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {

    <span class="keyword">if</span> !authenticator.<span class="property">faceIDLabelHidden</span> {
      <span class="type">VStack</span> {
        <span class="type">Button</span>(action: {
          <span class="keyword">if</span> authenticator.<span class="property">state</span> == .<span class="dotAccess">loggedIn</span> {
            <span class="comment">// Log out immediately.</span>
            authenticator.<span class="property">state</span> = .<span class="dotAccess">loggedOut</span>

          } <span class="keyword">else</span> {
            <span class="type">Task</span> {
              <span class="keyword">do</span> {
                <span class="keyword">try await</span> authenticator.<span class="call">check</span>()
              } <span class="keyword">catch</span> {
                <span class="call">print</span>(<span class="string">"Problem authenticating</span> \(error)<span class="string">"</span>)
              }
            }
          }
        }, label: { <span class="type">Label</span>(<span class="string">"Use Face ID"</span>, systemImage: <span class="string">"faceid"</span>) })
        <span class="type">Spacer</span>()
        <span class="keyword">if</span> (authenticator.<span class="property">state</span> == .<span class="dotAccess">loggedIn</span>) {
          <span class="type">Text</span>(<span class="string">"Logged in!"</span>)
        } <span class="keyword">else</span> {
          <span class="type">Text</span>(<span class="string">"Logged out!"</span>)
        }
      }
    } <span class="keyword">else</span> {
      <span class="type">Text</span>(<span class="string">"No authentication method available"</span>)
    }
  }
}
</code></pre><p>An <code>Authenticator</code>, which we'll define below, is used to handle the well, authentication. If the device we're on can support biometrics, a Button with a Face ID label is shown; otherwise a <code>Text</code> view tells the user no authentication method is available. You can also see that the <code>Button</code> performs an <code>async</code> task since the call to <code>authenticator.check()</code> is inside a <code>Task</code> block.</p><p>The <code>Authenticator</code> class looks like this:</p><pre><code><span class="keyword">class</span> Authenticator: <span class="type">ObservableObject</span> {

  <span class="keyword">var</span> context = <span class="type">LAContext</span>()   <span class="comment">//1</span>
  <span class="keyword">@Published var</span> state: <span class="type">AuthenticationState</span> = .<span class="dotAccess">loggedOut</span>  <span class="comment">//2</span>
  <span class="keyword">@Published var</span> faceIDLabelHidden = <span class="keyword">false</span>  <span class="comment">//3</span>

  <span class="keyword">init</span>() {
    context.<span class="call">canEvaluatePolicy</span>(.<span class="dotAccess">deviceOwnerAuthentication</span>, error: <span class="keyword">nil</span>) <span class="comment">//4</span>
    faceIDLabelHidden = (state == .<span class="dotAccess">loggedIn</span>) || (context.<span class="property">biometryType</span> != .<span class="dotAccess">faceID</span>) <span class="comment">//5</span>
  }

  <span class="keyword">func</span> check() <span class="keyword">async throws</span> {
    context = <span class="type">LAContext</span>()
    context.<span class="property">localizedCancelTitle</span> = <span class="string">"Enter Username/Password"</span>

    <span class="keyword">var</span> error: <span class="type">NSError</span>?
    <span class="keyword">if</span> context.<span class="call">canEvaluatePolicy</span>(.<span class="dotAccess">deviceOwnerAuthentication</span>, error: &amp;error) { <span class="comment">//6</span>
      <span class="keyword">try await</span> context.<span class="call">evaluatePolicy</span>(.<span class="dotAccess">deviceOwnerAuthentication</span>, localizedReason: <span class="string">"Log in to your account"</span>) <span class="comment">//7</span>
      <span class="type">DispatchQueue</span>.<span class="property">main</span>.<span class="call">async</span> { <span class="keyword">self</span>.<span class="property">state</span> = .<span class="dotAccess">loggedIn</span> } <span class="comment">//8</span>
    }
  }
}
</code></pre><p>Since this is new, let's break it down:</p><ol><li>Here an <code>LAContext</code> (Local Authentication context) is defined. This should be created for each check you make; using the same context as before may incorrectly let someone have access!</li><li>The initial authentication state is logged out</li><li>A boolean to describe whether the face ID log in button is hidden is marked false</li><li>The context checks to see what biometrics are supported on this device; this sets <code>context.biometryType</code> that is used below</li><li>If the device don't support Face ID, <code>faceIDLabelHidden</code> is set to true</li><li>The context is checked again to make sure that biometrics are available; there is a chance the user may have deactivated Face ID or Touch ID!</li><li><code>try await</code> is used to call <code>context.evaluatePolicy</code>; if Face ID is not available, a prompt for your device password is shown; otherwise the Face ID prompt is shown.</li><li>Since we're in an <code>async</code> block, publish the state changed on the main thread - thanks to <code>try await</code> if we've gotten this far, we've succeeded!</li></ol><p>Before running this on the simulator, you should go to the "Features -&gt; FaceID" menu in the simulator and choose "Enrolled" so this device is ready to go and shows the proper prompt. When running the app (as you can see in the GIF below), the view starts, stating the user is logged out. When I tap the "Use Face ID" button, the Face ID "waiting" prompt. I then went to "Features -&gt; FaceID" and chose "Matching Face" to authorize it</p><img src="../../../week10/FaceID.gif#centerResized" alt="FaceID"/><p style="float: left">Previous:  <A HREF="../../Week07/05-NotificationDetailExample/index.html">Notification Detail Example</A></p><p style="float: right">Next:  <A HREF="../../Week08/00-Week08Overview/index.html">Week 08 Overview</A></p><BR/><BR/></div><leftside><u><p>Week 10</p></u><div class="weekSection"><ul><li><div class="comment-container"><div class="tocItem"><a id="Week 10 Overview" href="../../Week10/00-Week10Overview/index.html">Week 10 Overview</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to App Intents" href="../../Week10/01-IntroductionToAppIntents/index.html">Introduction to App Intents</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="The App Entity Protocol" href="../../Week10/02-TheAppEntityProtocol/index.html">The App Entity Protocol</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="The App Intent Protocol" href="../../Week10/03-TheAppIntentProtocol/index.html">The App Intent Protocol</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Getting Ready for App Intents" href="../../Week10/04-GettingReadyForAppIntents/index.html">Getting Ready for App Intents</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Using App Intents with Search" href="../../Week10/05-UsingAppIntentsWithSearch/index.html">Using App Intents with Search</a></div></div></li></ul></div></leftside><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated March 9, 2025 at 6:49 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></div></body></html>