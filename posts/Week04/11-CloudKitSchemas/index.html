<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week04/11-CloudKitSchemas"/><meta name="twitter:url" content="https://hococoder.com/posts/Week04/11-CloudKitSchemas"/><meta name="og:url" content="https://hococoder.com/posts/Week04/11-CloudKitSchemas"/><title>Week 4 - CloudKit Database Schemas | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 4 - CloudKit Database Schemas | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 4 - CloudKit Database Schemas | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/test_ep_site/posts/Intro/About Me">AboutMe</a></li><li><a href="/test_ep_site/posts/Intro/Example App">ExampleApp</a></li><li><a href="/test_ep_site/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/test_ep_site/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/test_ep_site/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/test_ep_site/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/test_ep_site/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/test_ep_site/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/test_ep_site/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/test_ep_site/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/test_ep_site/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/test_ep_site/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/test_ep_site/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/test_ep_site/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/test_ep_site/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/test_ep_site/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/test_ep_site/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 4 - CloudKit Database Schemas</h1><p style="float: left">Previous:  <A HREF="../10-SettingUpCloudKit/index.html">Setting up CloudKit</A></p><p style="float: right">Next:  <A HREF="../12-CloudKitFeatures/index.html" class="nextModule">CloudKit Features</A></p><BR/><BR/><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_8wg2cop1?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_8wg2cop1&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><h2>Making a Database Schema</h2><p>When it comes to making database schemas, you don’t have to have one predefined. During your app development, you can use something called “Just-In-Time Schema”. As you construct objects, records, which you can think of as database tables, can be constructed from the fields of the object, as long as they are basic types such as Strings or Ints. When you pair this record with a unique name, it can be saved to the cloud. Don’t forget to use your iCloud credentials when testing your schema!</p><p>The video below from an earlier session of the class shows you the syntax involved with setting up such a Just-In-Time Schema in your code (see the code below).</p><h3>Example</h3><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_xqma1lc3?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_xqma1lc3&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p class="new">
The example code below is part of the "CloudKitTest" project in the resources bundle for this week.  It has 2 key changes:  1) The code below is triggered via a button in the main ContentView, and 2) The CKContainer uses a named container, instead of CKContainer.default().  The named container you use should match the one created and selected in the Project Settings under iCloud Capabilities
</p><pre><code><span class="keyword">import</span> CloudKit

<span class="keyword">let</span> studentID = <span class="type">CKRecord</span>.<span class="type">ID</span>(recordName: <span class="string">"1234"</span>)

<span class="keyword">let</span> student = <span class="type">CKRecord</span>(recordType: <span class="string">"Student"</span>, recordID: studentID)
student[<span class="string">"id"</span>] = <span class="string">"1234"</span> <span class="keyword">as</span> <span class="type">NSString</span>
student[<span class="string">"name"</span>] = <span class="string">"Josh Steele"</span> <span class="keyword">as</span> <span class="type">NSString</span>

<span class="keyword">let</span> myContainer = <span class="type">CKContainer</span>(identifier: <span class="string">"iCloud.edu.jh.ep.steele.josh.CloudKitTest.CK2021"</span>)  
<span class="comment">//for the homework you will replace the identifier to match the one with your JHED</span>

<span class="keyword">let</span> privateDatabase = myContainer.<span class="property">privateCloudDatabase</span>

privateDatabase.<span class="call">save</span>(student) { record, error <span class="keyword">in 
  if let</span> error = error {
    <span class="call">print</span>(<span class="string">"We encountered an error saving to the cloud</span> \(error)<span class="string">"</span>)
    <span class="keyword">return</span>
  }
  <span class="call">print</span>(<span class="string">"Save successful!  Go check it out in the CloudKit Dashboard!"</span>)
}

</code></pre><p>If you already have a database structure in mind, or if you want to confirm that your just-in-time schema creation works. you can view them in the CloudKit Dashboard. A private database is also available, and any schemas made during development can be deployed to an active environment.</p><img src="../../../week04/CloudKitDashboard0-F2021.png#centerResizedSlide" alt="The Main CloudKit Landing Page"/><img src="../../../week04/CloudKitDashboard1-F2021.png#centerResizedSlide" alt="The Main Dashboard View for our Container"/><p>Each record type and its attributes can be configured right in the dashboard.<br><br> <img src="../../../week04/CloudKitDashboard2-F2021.png#centerResizedSlide" alt="The Schema Screen"/></p><p class="info">Important Note: If you use Just-In-Time schema, they are NOT immediately queryable via the CloudKit Dashboard Data area.  You have to go to that type in the Schema, select "Edit Index", and add a new index for the "recordName" field, and then click "Save Changes". Once this been done, you can go to the Data type and search on that type.</p><img src="../../../week04/RecordNameIndex-F2021.png#centerResizedSlide" alt="Record Name Index"/><p style="float: left">Previous:  <A HREF="../10-SettingUpCloudKit/index.html">Setting up CloudKit</A></p><p style="float: right">Next:  <A HREF="../12-CloudKitFeatures/index.html" class="nextModule">CloudKit Features</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2022-2023 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated August 27, 2022, 9:31 PM</p><p><a href="https://twitter.com/hococoder" target="_blank">My Twitter</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://blackboard.jhu.edu" target="_blank">JHU Blackboard</a></p></footer></body></html>