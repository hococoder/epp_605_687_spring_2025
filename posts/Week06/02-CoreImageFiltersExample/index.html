<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week06/02-CoreImageFiltersExample"/><meta name="twitter:url" content="https://hococoder.com/posts/Week06/02-CoreImageFiltersExample"/><meta name="og:url" content="https://hococoder.com/posts/Week06/02-CoreImageFiltersExample"/><title>Week 6 - Core Image Filters Example | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 6 - Core Image Filters Example | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 6 - Core Image Filters Example | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><script src="../../../../jquery-3.7.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><div class="layout"><div class="header"><div class="headerLayout"><div class="title">Mobile Application Development for the iOS Platform</div><div class="subtitle">Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year</div><div class="weeklayout"><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/About Me">About Me</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/Example App">Example App</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week00/00-Week00Overview">Week 0</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week01/00-Week01Overview">Week 1</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week02/00-Week02Overview">Week 2</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week03/00-Week03Overview">Week 3</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week04/00-Week04Overview">Week 4</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week05/00-Week05Overview">Week 5</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week06/00-Week06Overview">Week 6</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week07/00-Week07Overview">Week 7</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week08/00-Week08Overview">Week 8</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week09/00-Week09Overview">Week 9</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week10/00-Week10Overview">Week 10</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week11/00-Week11Overview">Week 11</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week12/00-Week12Overview">Week 12</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week13/00-Week13Overview">Week 13</a></div></div></div><div class="wrapper"><h1>Week 6 - Core Image Filters Example</h1><p style="float: left">Previous:  <A HREF="../../Week06/01-IntroductionToCoreImage/index.html">Introduction to CoreImage</A></p><p style="float: right">Next:  <A HREF="../../Week06/03-VisionFaceDetectionExample/index.html">Vision Face Detection Example</A></p><BR/><BR/><center><iframe id="myIframe" src="https://jh.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=2fa7f4d0-e8cd-4a8d-96cb-b1ba014e5f0c&autoplay=false&offerviewer=true&showtitle=true&showbrand=true&captions=false&interactivity=all"  style="border: 1px solid #464646;" allowfullscreen allow="autoplay" aria-label="Panopto Embedded Video Player" aria-description="Week0-04-THIRDPARTYTOOLS-Lecture" ></iframe></center><p>There are a series of built in <code>CoreImage</code> filters that you can apply to an image, and even chain together in order to apply multiple filters at the same time. In my project, I've got a SwiftUI view with an image and 2 buttons already set up - one to add a filter, and another to detect faces, which you'll learn about in the next video.</p><p>At the top of the <code>CoreImageView</code>, I've declared a <code>CIContext</code> - which is our scratch space - and a filter that performs a disc blur. There are also <code>@State</code> properties wrappers for the Image itself, as well as a UIImage - which is how you create images in UIKit. This is because the line from SwiftUI to <code>CoreImage</code> is... a long and winding road, but one we'll navigate down.</p><pre><code><span class="keyword">let</span> context = <span class="type">CIContext</span>(options: <span class="keyword">nil</span>)
<span class="keyword">let</span> ciFilter = <span class="type">CIFilter</span>.<span class="call">discBlur</span>()
<span class="keyword">@State var</span> image: <span class="type">Image</span>?
<span class="keyword">@State var</span> uiImage: <span class="type">UIImage</span>!
</code></pre><p>In the <code>body</code> for the <code>View</code>, there is a <code>VStack</code> with the <code>Image</code> and 2 buttons.</p><p class="new"> Note that I've removed the resizeable and aspectRatio modifiers from the image - they were interfering with the placement of the face regions in the next module.  I've also cleaned up the UI layout a bit.</p><pre><code><span class="type">VStack</span>(alignment: .<span class="dotAccess">center</span>) {
    image
    <span class="type">Spacer</span>()
    <span class="type">HStack</span> {
      <span class="type">Button</span>(<span class="string">"Apply Filter"</span>) { <span class="keyword">self</span>.<span class="call">applyFilter</span>() }
      <span class="type">Spacer</span>()
      <span class="type">Button</span>(<span class="string">"Find Faces"</span>) { <span class="keyword">self</span>.<span class="call">boxFaces</span>()  }
    }.<span class="call">padding</span>()
}.<span class="call">onAppear</span>(perform: loadImage)
</code></pre><p>You may have picked up on a few things. First, the image property is optional, and isn't immediately set. Even when the view is defined, the image isn't set, but remains declared as optional, and only on the <code>VStack</code> appearing do we call the method <code>loadImage</code>, which is located below the <code>body</code> declaration.</p><pre><code><span class="keyword">func</span> loadImage() {

  <span class="keyword">guard let</span> uiImage = <span class="type">UIImage</span>(named: <span class="string">"cook_scaled"</span>) <span class="keyword">else</span> { <span class="keyword">return</span> }
  <span class="keyword">self</span>.<span class="property">uiImage</span> = uiImage
  image = <span class="type">Image</span>(uiImage: uiImage)
}

</code></pre><p>This method attempts to load the image via a UIImage, and if it makes it past the guard, sets the <code>uiImage</code> property, and initializes the <code>Image</code> with that <code>UIImage</code>.</p><p>Now, let's define the <code>applyFilter</code> function. First, make a <code>CIImage</code> from the <code>uiImage</code> (<code>CIImage</code> is a <code>CoreImage</code> Image)</p><pre><code><span class="keyword">func</span> applyFilter()
{
  <span class="keyword">let</span> ciImage = <span class="type">CIImage</span>(image: uiImage)
</code></pre><p>Next, take the filter, and set the input image for it, via the <code>setValue</code> method. <code>kCIInputImageKey</code> here is a constant defined in <code>CoreImage</code>. Also set the blur radius to 4</p><pre><code>  ciFilter.<span class="call">setValue</span>(ciImage, forKey: kCIInputImageKey)
  ciFilter.<span class="property">radius</span> = <span class="number">4</span>
</code></pre><p>Then, grab the output image from the filter, and if that fails, return</p><pre><code>  <span class="keyword">guard let</span> outputImage = ciFilter.<span class="property">outputImage</span> <span class="keyword">else</span> { <span class="keyword">return</span> }
</code></pre><p>Then - and here is where it gets wild - use the <code>context</code> to convert the <code>outputImage</code> (using the size defined in the <code>outputImage</code>'s <code>extent</code>) into a <code>CoreGraphics</code> image. Then from that, create a <code>UIImage</code>, and then from <em>that</em> set the SwiftUI <code>Image</code> property, which will cause the view to refresh since we marked it as a <code>@State</code> property.</p><pre><code><span class="keyword">if let</span> cgimg = context.<span class="call">createCGImage</span>(outputImage, from: outputImage.<span class="property">extent</span>) {
    <span class="comment">// convert that to a UIImage</span>
    uiImage = <span class="type">UIImage</span>(cgImage: cgimg)
    <span class="comment">// and convert that to a SwiftUI image</span>
    image = <span class="type">Image</span>(uiImage: uiImage!)
}

</code></pre><p>Run that in the simulator and you can see the image get blurry when you tap on the button.</p><p>You can also easily apply another filter using <code>applyingFilter</code> to the first outputImage, and using the output from <em>that</em> filter to create the <code>Image</code> object. <code>applyingFilter</code> takes in the name of a filter as well as a dictionary of parameters for that filter. Here we are setting the <code>intensity</code> for the SepiaTone filter to 1.0.</p><pre><code>  <span class="keyword">let</span> outputImage2 = outputImage.<span class="call">applyingFilter</span>(<span class="string">"CISepiaTone"</span>, parameters: [kCIInputIntensityKey : <span class="number">1.0</span>])
      
  <span class="keyword">if let</span> cgimg = context.<span class="call">createCGImage</span>(outputImage2, from: outputImage2.<span class="property">extent</span>) {
      <span class="comment">// convert that to a UIImage</span>
      uiImage = <span class="type">UIImage</span>(cgImage: cgimg)
      <span class="comment">// and convert that to a SwiftUI image</span>
      image = <span class="type">Image</span>(uiImage: uiImage!)
  }
}

</code></pre><p>Run that again and you'll see that the image gets blurry and turns to a sepia tone.<br><br>Core Image’s filter API is pretty straightforward to use (except when using SwiftUI, which hopefully will improve soon), letting you apply and combine filters to images. If you have any questions about the examples in this video, please post them in the forums.</p><p style="float: left">Previous:  <A HREF="../../Week06/01-IntroductionToCoreImage/index.html">Introduction to CoreImage</A></p><p style="float: right">Next:  <A HREF="../../Week06/03-VisionFaceDetectionExample/index.html">Vision Face Detection Example</A></p><BR/><BR/></div><leftside><u><p>Week 6</p></u><div class="weekSection"><ul><li><div class="comment-container"><div class="tocItem"><a id="Week 06 Overview" href="../../Week06/00-Week06Overview/index.html">Week 06 Overview</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to CoreImage" href="../../Week06/01-IntroductionToCoreImage/index.html">Introduction to CoreImage</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="CoreImage Filters Example" href="../../Week06/02-CoreImageFiltersExample/index.html">CoreImage Filters Example</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Vision Face Detection Example" href="../../Week06/03-VisionFaceDetectionExample/index.html">Vision Face Detection Example</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Making Custom Controls With SwiftUI" href="../../Week06/04-MakingCustomControlsWithSwiftUI/index.html">Making Custom Controls With SwiftUI</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Making Custom Controls With CoreGraphics" href="../../Week06/05-MakingCustomControlsWithCoreGraphics/index.html">Making Custom Controls With CoreGraphics</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to SwiftUI Charts" href="../../Week06/06-IntroductionToSwiftUICharts/index.html">Introduction to SwiftUI Charts</a></div></div></li></ul></div></leftside><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated March 23, 2025 at 3:44 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></div></body></html>