<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week06/01-IntroductionToCoreImage"/><meta name="twitter:url" content="https://hococoder.com/posts/Week06/01-IntroductionToCoreImage"/><meta name="og:url" content="https://hococoder.com/posts/Week06/01-IntroductionToCoreImage"/><title>Week 6 - Core Image | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 6 - Core Image | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 6 - Core Image | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_fall_2022/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_fall_2022/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_fall_2022/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_fall_2022/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_fall_2022/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_fall_2022/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_fall_2022/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_fall_2022/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_fall_2022/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_fall_2022/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_fall_2022/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_fall_2022/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_fall_2022/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_fall_2022/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_fall_2022/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_fall_2022/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/epp_605_687_fall_2022/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 6 - Core Image</h1><p style="float: left">Previous:  <A HREF="../00-Week06Overview/index.html">Week 6 Overview</A></p><p style="float: right">Next:  <A HREF="../02-CoreImageFiltersExample/index.html" class="nextModule">Core Image Filters Example</A></p><BR/><BR/><h2>Overview</h2><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_3ra8og3v?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_3ra8og3v&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p>In this module we’ll discuss how the <code>CoreImage</code> framework allows you manipulate and analyze images.</p><p>The <code>CoreImage</code> runtime is a layer that sits just above the rendering layer in iOS. It can take inputs from other frameworks such as a <code>CoreGraphics</code>, <code>Core Video</code>, and <code>ImageIO</code>, and perform transformations in the form of filters on that input.</p><img src="../../../week06/CoreImagePipeline.png#centerResizedSlide" alt="The CoreImage Pipeline"/><p>Core Image has 3 main features:</p><ul><li>Image processing, by way of filters,</li><li>Feature detection, such as faces, and</li><li>Image enhancement, such as sharpening or red eye removal</li></ul><h2>Core Image Filters</h2><p>Filters are pieces of code that manipulate images, on a pixel by pixel basis. Filters take in and pass out <code>CIImage</code> objects and the <code>CIFilter</code> class contains the code to manipulate the <code>CIImage</code>.</p><p>Using a predefined filter is fairly straightforward.</p><pre><code><span class="comment">//Create a filter and set parameters</span>
<span class="keyword">let</span> filter = <span class="type">CIFilter</span>(name: <span class="string">"CISepiaTone"</span>)
filter.<span class="call">setValue</span>(<span class="number">0.8</span>, forKey: kCIInputIntensityKey)

<span class="comment">//Create an image and set the filter's input value</span>
<span class="keyword">let</span> image = <span class="type">CIImage</span>(contentsOfURL: myURL)
filter.<span class="call">setValue</span>(image, forKey: kCIInputImageKey)

<span class="comment">//Get the output image from the filter</span>
<span class="keyword">let</span> result = filter.<span class="property">outputImage</span>!
<span class="keyword">let</span> cgImage = context.<span class="call">createCGImage</span>(result, from: result.<span class="property">extent</span>)

</code></pre><ul><li>First, you can make an optional <code>CIContext</code> (a scratch space very similar to a CoreData Context). The <code>CIContext</code> creation is optional because sometimes you may be able to get one that already exists from the environment you are running the filter in.</li><li>Next, make a <code>CIFilter</code> object, and set any properties, if needed. In the example here, we’re making a <code>CISepiaTone</code> filter and setting the intensity to 0.8.</li><li>Then either reference or create a <code>CIImage</code> to pass into filter. Then, set the image as the input of the filter via the <code>kCIInputImageKey</code>.</li><li>Finally, grab the <code>outputImage</code> from the filter, and create the <code>CoreImage</code> object from the output image.</li></ul><p>Since a filter outputs a <code>CoreImage</code> object, it can be passed into a subsequent filter for future processing, forming a chain of filters. Filter can be composed with a <code>filterName</code> and an array of input parameters. The output image of that filter can be applied to another filter with another set of input parameters and so forth.</p><p>Using filters in <code>CoreImage</code> can done easily in <code>UIKit</code>. Both <code>UIImage</code> and <code>CIImage</code> have init methods that take the other object in as parameters. Once you get an <code>UIImage</code> object, you can use that to create a <code>UIImageView</code> that you can present to the user.</p><p>Notice how I mentioned <code>UIKIt</code> there, and not SwiftUI? Yeah. As of right now (iOS 14) <code>CIImage</code> can only read in <code>UIImage</code> objects - not <code>Image</code> objects from SwiftUI - so there is some hoop jumping if you want to use <code>CoreImage</code> in a SwiftUI app. We'll see that in the example code.</p><p>Filters in <code>CoreImage</code> are categorized, and have more than 1 category. The <code>filterNamesInCategory</code> and <code>filterNamesInCategories</code> methods can be used to return filters for a given set of categories. This categories can describe the filter effect, what they can be used with (images or video for example), and whether the filter is a built in <code>CoreImage</code> filter or not.</p><h2>Detecting Faces</h2><p>Another of <code>CoreImage</code>’s features is the ability to detect faces in an image. Note here that this is detection, not recognition (which is done in apps like Photos). Once a face has been detected, particular facial features can also be provided by the API - eye and mouth positions, for example. Once you’ve identified those features, you can do other actions like red eye removal.</p><p>In iOS 11, face detection is getting smarter. Thanks to the introduction of the vision framework, you’ll be able to detect the face contour, the median line, the eyes, the eyebrows, the nose, lips, and pupil positions.</p><h2>Image Enhancement</h2><p>Finally, Core Image can enhance image with a built in set of auto enhancement filters. Red Eye correction, face balance, vibrance, the tone, and shadows. The <code>autoAdjustmentFilters</code> API analyzes the image using all of these enhancements, and provides a series of filters that you can choose to apply.</p><p>We'll look at example of apply filters and performing face detection in the next few modules.</p><p style="float: left">Previous:  <A HREF="../00-Week06Overview/index.html">Week 6 Overview</A></p><p style="float: right">Next:  <A HREF="../02-CoreImageFiltersExample/index.html" class="nextModule">Core Image Filters Example</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated August 25, 2023 at 7:13 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>