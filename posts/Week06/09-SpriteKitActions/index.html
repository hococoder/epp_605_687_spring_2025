<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week06/09-SpriteKitActions"/><meta name="twitter:url" content="https://hococoder.com/posts/Week06/09-SpriteKitActions"/><meta name="og:url" content="https://hococoder.com/posts/Week06/09-SpriteKitActions"/><title>Week 6 - SpriteKit Actions | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 6 - SpriteKit Actions | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 6 - SpriteKit Actions | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_fall_2023/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_fall_2023/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_fall_2023/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_fall_2023/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_fall_2023/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_fall_2023/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_fall_2023/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_fall_2023/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_fall_2023/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_fall_2023/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_fall_2023/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_fall_2023/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_fall_2023/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_fall_2023/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_fall_2023/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_fall_2023/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/epp_605_687_fall_2023/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 6 - SpriteKit Actions</h1><p style="float: left">Previous:  <A HREF="../08-SpriteKitScenes/index.html">SpriteKit Scenes</A></p><p style="float: right">Next:  <A HREF="../10-SpriteKitPhysics/index.html" class="nextModule">SpriteKit Physics</A></p><BR/><BR/><h2>Actions</h2><p>Sprites can be acted upon in your scene by the use of a <code>SKAction</code>. You can move, add, remove, play sounds, apply physics, and animate your sprites, among other actions. An example of a <code>moveTo(to: duration:)</code> action is shown below. You provide a <code>CGPoint</code> on screen to move to, and an interval over which to animate the move (thereby defining a speed). Actions can also be reversed, with a simple call to the <code>reversedAction()</code> method. You can also repeat an action a certain number of times - as well as indefinitely, as long as the <code>SKScene</code> exists. An example of such a repeat request is shown below.</p><pre><code><span class="keyword">let</span> action = <span class="type">SKAction</span>.<span class="call">move</span>(to: <span class="type">CGPoint</span>(x: -ship.<span class="property">size</span>.<span class="property">width</span>/<span class="number">2</span>, y: actualY), duration: <span class="type">TimeInterval</span>(actualDuration))
<span class="keyword">let</span> reversedAction = action.<span class="call">reversedAction</span>()

scene?.<span class="call">run</span>(<span class="type">SKAction</span>.<span class="call">repeatForever</span>(<span class="type">SKAction</span>.<span class="call">sequence</span>([<span class="type">SKAction</span>.<span class="call">run</span>({ <span class="comment">/*adds a monster*/</span>}), <span class="type">SKAction</span>.<span class="dotAccess">wait</span> (forDuration: <span class="number">1.0</span>)])))
</code></pre><p>Another editor in the scene editor is the action editor (open up the Action Editor view in GameScene.sks). A video editing-like timeline interface allows you to drop actions such as scaling and move actions on the timeline of the various nodes in your scene, if you are building your scene in the visual editors.</p><h3>Sounds</h3><p>While you’re acting on your sprites, you can also play some great immersive sounds to give your user a great experience. Methods such as <code>playSoundFileNamed</code> on <code>SKAction</code> allows you to play sounds from your asset catalog. You also have the option of changing the playback rate, volume, and stereo balance.</p><h2>Actions Example</h2><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_rnxjqepd?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_rnxjqepd&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p>Make a new method called <code>addAsteroid()</code> that we’ll use to setup the creation of the asteroids. We want to have the asteroids appear at random y values when they come into the scene. We also want to make it look like the ship is flying through a field of those asteroids, but instead of moving the ship, we’ll move the asteroids to simulate this motion.</p><pre><code>   <span class="keyword">func</span> addAsteroid()
  {
    <span class="keyword">let</span> asteroid = <span class="type">SKSpriteNode</span>(imageNamed: <span class="string">"asteroid"</span>)
    asteroid.<span class="property">xScale</span> = <span class="number">0.5</span>
    asteroid.<span class="property">yScale</span> = <span class="number">0.5</span>

    <span class="keyword">let</span> actualY = <span class="call">random</span>(min:asteroid.<span class="property">size</span>.<span class="property">height</span>/<span class="number">2</span>, max:size.<span class="property">height</span> - asteroid.<span class="property">size</span>.<span class="property">height</span>/<span class="number">2</span>)
    asteroid.<span class="property">position</span> = <span class="type">CGPoint</span>(x: size.<span class="property">width</span> + asteroid.<span class="property">size</span>.<span class="property">width</span>/<span class="number">2</span>, y: actualY)
    
    <span class="call">addChild</span>(asteroid)
        
    <span class="keyword">let</span> actualDuration = <span class="call">random</span>(min:<span class="type">CGFloat</span>(<span class="number">2.0</span>), max: <span class="type">CGFloat</span>(<span class="number">4.0</span>))
    
    <span class="keyword">let</span> actionMove = <span class="type">SKAction</span>.<span class="call">move</span>(to: <span class="type">CGPoint</span>(x:-asteroid.<span class="property">size</span>.<span class="property">width</span>/<span class="number">2</span>, y:actualY), duration: <span class="type">TimeInterval</span>(actualDuration))
    <span class="keyword">let</span> actionMoveDone = <span class="type">SKAction</span>.<span class="call">removeFromParent</span>()
    asteroid.<span class="call">run</span>(<span class="type">SKAction</span>.<span class="call">sequence</span>([actionMove, actionMoveDone]))
  }
</code></pre><p>Let's break down what is going on here. First, let’s setup the sprite like we did with the ship and shields.</p><pre><code>   <span class="keyword">func</span> addAsteroid()
  {
     <span class="keyword">let</span> asteroid = <span class="type">SKSpriteNode</span>(imageNamed: <span class="string">"asteroid"</span>)
     asteroid.<span class="property">xScale</span> = <span class="number">0.5</span>
     asteroid.<span class="property">yScale</span> = <span class="number">0.5</span>
</code></pre><p>When it comes to the position however, I want to randomize the Y value. Before we do that, let’s add a helper method for that:</p><pre><code><span class="keyword">func</span> random(min: <span class="type">CGFloat</span>, max: <span class="type">CGFloat</span>) -&gt; <span class="type">CGFloat</span>
{
  <span class="keyword">return</span> <span class="type">CGFloat</span>.<span class="call">random</span>(in: min...max)
}
</code></pre><p>OK, back to the <code>addAsteroid()</code> function. Using that method, get a random Y value for the height. I’ll clamp the range by the size of the asteroid so part of it doesn’t appear off screen in the vertical direction. I do however want the starting x position to be offscreen, so I’ll set it to the view’s width plus half the width of the asteroid. Add the asteroid to the scene</p><pre><code>       <span class="keyword">let</span> actualY = <span class="call">random</span>(min:asteroid.<span class="property">size</span>.<span class="property">height</span>/<span class="number">2</span>, max:size.<span class="property">height</span> - asteroid.<span class="property">size</span>.<span class="property">height</span>/<span class="number">2</span>)
      asteroid.<span class="property">position</span> = <span class="type">CGPoint</span>(x: size.<span class="property">width</span> + asteroid.<span class="property">size</span>.<span class="property">width</span>/<span class="number">2</span>, y: actualY)
     
      <span class="call">addChild</span>(asteroid)
</code></pre><p>Since I want to animate the asteroids, I need to apply an action on them - in this case a move action - and for that I’ll need a duration over which to move the asteroid. Let’s again use the random number generator to get a duration between 2 and 4 seconds. Combining this with the total distance traveled by the asteroid on screen will dictate its speed.</p><pre><code>       <span class="keyword">let</span> actualDuration = <span class="call">random</span>(min:<span class="type">CGFloat</span>(<span class="number">2.0</span>), max: <span class="type">CGFloat</span>(<span class="number">4.0</span>))
}

</code></pre><p>Let’s define the action. Using <code>SKAction</code>’s <code>move(to:duration:)</code> method, put the final destination (same Y values, but this time off screen on the left hand side) and the duration we calculated earlier. Let’s also define another action called <code>actionMoveDone</code> that will invoke <code>SKAction</code>’s <code>removeFromParent()</code> method. Then, let’s call the run method on the asteroid to have it invoke the sequence of <code>actionMove</code>, followed by <code>actionMoveDone</code>, which will move the asteroid and remove it from the parent when it is done.</p><pre><code>       <span class="keyword">let</span> actionMove = <span class="type">SKAction</span>.<span class="call">move</span>(to: <span class="type">CGPoint</span>(x:-asteroid.<span class="property">size</span>.<span class="property">width</span>/<span class="number">2</span>, y:actualY), duration: <span class="type">TimeInterval</span>(actualDuration))
      <span class="keyword">let</span> actionMoveDone = <span class="type">SKAction</span>.<span class="call">removeFromParent</span>()
      asteroid.<span class="call">run</span>(<span class="type">SKAction</span>.<span class="call">sequence</span>([actionMove, actionMoveDone]))

</code></pre><p>To get all this running in our scene, we need to call <code>addAsteroid()</code> many times, as long as we are running the app. To do that, we can use the scene’s run method, and invoke <code>SKActions</code>’s <code>runForever</code> method to run the sequence of <code>addAsteroid()</code> followed by a wait of 1 second. Add the following to <code>sceneDidLoad()</code></p><pre><code>   <span class="call">run</span>(<span class="type">SKAction</span>.<span class="call">repeatForever</span>(<span class="type">SKAction</span>.<span class="call">sequence</span>(
   [
     <span class="type">SKAction</span>.<span class="call">run</span>(addAsteroid),
     <span class="type">SKAction</span>.<span class="call">wait</span>(forDuration: <span class="number">1.0</span>)
   ])))
</code></pre><p>Let’s try running that and see what happens.</p><p>OK, we’ve got asteroids appearing, and traveling across the screen. But, they’re passing right through the shield and ship! Not only that but their y direction is trending downwards. To fix this we’ll need to introduce the concept of physics and collisions into our scenes - we'll do that next. Another thing to note - the frame rate is pretty good in the simulator, at 60 fps! This is due to the Simulator having access to the Metal library on OS X, allowing for optimal graphics rendering.</p><p style="float: left">Previous:  <A HREF="../08-SpriteKitScenes/index.html">SpriteKit Scenes</A></p><p style="float: right">Next:  <A HREF="../10-SpriteKitPhysics/index.html" class="nextModule">SpriteKit Physics</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated September 4, 2023 at 10:46 AM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>