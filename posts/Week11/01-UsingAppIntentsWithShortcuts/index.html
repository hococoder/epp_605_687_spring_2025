<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week11/01-UsingAppIntentsWithShortcuts"/><meta name="twitter:url" content="https://hococoder.com/posts/Week11/01-UsingAppIntentsWithShortcuts"/><meta name="og:url" content="https://hococoder.com/posts/Week11/01-UsingAppIntentsWithShortcuts"/><title>Week 11 - Using App Intents With Shortcuts | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 11 - Using App Intents With Shortcuts | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 11 - Using App Intents With Shortcuts | Mobile Application Development for the iOS Platform"/><meta name="description" content="Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year"/><meta name="twitter:description" content="Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year"/><meta name="og:description" content="Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><script src="../../../../jquery-3.7.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><div class="layout"><div class="header"><div class="headerLayout"><div class="title">Mobile Application Development for the iOS Platform</div><div class="subtitle">Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year</div><div class="weeklayout"><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/About Me">About Me</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Intro/Example App">Example App</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week00/00-Week00Overview">Week 0</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week01/00-Week01Overview">Week 1</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week02/00-Week02Overview">Week 2</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week03/00-Week03Overview">Week 3</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week04/00-Week04Overview">Week 4</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week05/00-Week05Overview">Week 5</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week06/00-Week06Overview">Week 6</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week07/00-Week07Overview">Week 7</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week08/00-Week08Overview">Week 8</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week09/00-Week09Overview">Week 9</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week10/00-Week10Overview">Week 10</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week11/00-Week11Overview">Week 11</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week12/00-Week12Overview">Week 12</a><a class="grow1" href="/epp_605_687_spring_2025/posts/Week13/00-Week13Overview">Week 13</a></div></div></div><div class="wrapper"><h1>Week 11 - Using App Intents With Shortcuts</h1><p style="float: left">Previous:  <A HREF="../../Week11/00-Week11Overview/index.html">Week 11 Overview</A></p><p style="float: right">Next:  <A HREF="../../Week11/02-UsingAppIntentsWithActionButton/index.html">Using App Intents with Action Button</A></p><BR/><BR/><div id="floater">
<h3><u>Page Contents</u></h3>
<ul><li><a href="#overview">Overview</a></li><li><a href="#shortcutsNeedAppIntents">Shortcuts Need App Intents</a></li><li><a href="#makeSureYouHaveSuggestedEntities">Make Sure you have Suggested Entities</a></li><li><a href="#creatingShortcuts">Creating Shortcuts</a></li><li><a href="#updatingShortcutParameters">Updating Shortcut Parameters</a></li><li><a href="#tryingYourShortcutInTheShortcutsApp">Trying your Shortcut in the Shortcuts App</a></li></ul></div><a name="overview"></a>
<h2>Overview</h2><p>It's very easy to connect your app intents into the Shortcuts app on iOS. Let's take a look.</p><a name="shortcutsNeedAppIntents"></a>
<h2>Shortcuts Need App Intents</h2><p>We defined app intents last week, and they are the "verbs" in your App Intent sentence structure. Shortcuts calls these intents to fire certain actions in your app. If you recall, the <code>perform</code> method can return many things, including user interface elements. For example, this</p><pre><code>   <span class="keyword">@Dependency private var</span> lessonManager: <span class="type">LessonDataManager</span>

  <span class="keyword">func</span> perform() <span class="keyword">async throws</span> -&gt; <span class="keyword">some</span> <span class="type">IntentResult</span> &amp; <span class="type">ReturnsValue</span>&lt;<span class="type">LessonEntity</span>&gt; &amp; <span class="type">ProvidesDialog</span> &amp; <span class="type">ShowsSnippetView</span> {
    <span class="keyword">guard let</span> lessonData = lessonManager.<span class="call">lesson</span>(with: lessonToGet.<span class="property">id</span>) <span class="keyword">else</span> {
      <span class="keyword">throw</span> <span class="type">LessonIntentError</span>.<span class="property">lessonNotFound</span>
    }
    <span class="comment">/**
    You provide a custom view by conforming the return type of the `perform()` function to the `ShowsSnippetView` protocol.
    */</span>
    <span class="keyword">let</span> snippet = <span class="type">DetailView</span>(lesson: lessonData)

    <span class="comment">/**
    This intent displays a custom view that includes the lesson details as part of the view. The dialog includes the lesson details when
    the system can only read the response, but not display it. When the system can display the response, the dialog shows a shorter introductory string to the data.
    */</span>
    <span class="keyword">let</span> dialog = <span class="type">IntentDialog</span>(
      full: <span class="string">"""
      The due date for</span> \(lessonToGet.<span class="property">name</span>) <span class="string">is</span> \(lessonToGet.<span class="property">lessonDueDate</span>.<span class="call">formatted</span>())
      <span class="string">and has the following description:</span> \(lessonToGet.<span class="property">lessonDescription</span>)<span class="string">.
      """</span>,
      supporting: <span class="string">"Here's the information on the requested to do item."</span>)
    <span class="keyword">return</span> .<span class="call">result</span>(value: lessonToGet, dialog: dialog, view: snippet)
  }
</code></pre><p>So what's going on here? - First the guard statement checks to see there is an entity with that ID - The <code>snippet</code> property is an instance of some SwiftUI view that holds information for the entity in questions - Then the dialog is defined, which looks complicated but isn't really. It contains 2 strings: one, the <code>full</code> one will be read aloud if the screen isn't available (think on a HomePod) and the <code>supporting</code> string will appear above the content when the view can be shown on screen. - The <code>.result</code> contains 3 things: the matching entity, the dialog, and the view.<br><br>You can add this into your favorite intent to make data available to either the screen via SwiftUI or via Siri courtesy of the content in the <code>full</code> property.</p><a name="makeSureYouHaveSuggestedEntities"></a>
<h2>Make Sure you have Suggested Entities</h2><p>If your intent can take parameters, you should definitely (in my opinion, and of course if it makes sense for your app) implement the optional <code>suggestedEntities()</code> function in your <code>EntityQuery</code> class:</p><pre><code>   <span class="keyword">func</span> suggestedEntities() <span class="keyword">async throws</span> -&gt; [<span class="type">LessonEntity</span>] {
    <span class="keyword">return</span> lessonManager.<span class="property">lessons</span>.<span class="call">map</span> { <span class="type">LessonEntity</span>(lesson: $0) }
  }

</code></pre><p>This provides the user with a list of options to choose from if they don't search for anything when the shortcut is presented (you'll see this dialog below).</p><p>You should also make your sure <code>EntityQuery</code> class adopts the <code>EntityStringQuery</code> protocol, and include a function like this (ours already does):</p><pre><code>   <span class="keyword">func</span> entities(matching string: <span class="type">String</span>) <span class="keyword">async throws</span> -&gt; [<span class="type">LessonEntity</span>] {
    <span class="keyword">return</span> lessonManager
      .<span class="call">lessons</span> { lesson <span class="keyword">in</span>
        lesson.<span class="property">name</span>.<span class="call">localizedCaseInsensitiveContains</span>(string)
      }
      .<span class="call">map</span> { <span class="type">LessonEntity</span>(lesson: $0) }
  }
</code></pre><p>This allows a spoken string - say, one spoken to Siri (or even types to Siri in the new iOS 18.1 Siri interface) - can be used as the search criteria for the entities in your app.<br><br>## Creating Shortcuts</p><p>You construct shortcuts and register them with a class that adopts <code>AppShortcutsProvider</code>. Here's an example:</p><pre><code><span class="keyword">class</span> LessonShortcuts: <span class="type">AppShortcutsProvider</span> {
  <span class="comment">/// The color the system uses to display the App Shortcuts in the Shortcuts app.</span>
  <span class="keyword">static var</span> shortcutTileColor = <span class="type">ShortcutTileColor</span>.<span class="property">navy</span>

  <span class="keyword">static var</span> appShortcuts: [<span class="type">AppShortcut</span>] {
    <span class="type">AppShortcut</span>(
      intent: <span class="type">GetLessonDetails</span>(),
      phrases: [
      ],
      shortTitle: <span class="string">"Get Details"</span>,
      systemImageName: <span class="string">"cloud.rainbow.half"</span>,
      parameterPresentation: <span class="type">ParameterPresentation</span>(
        for: \.<span class="property">$lessonToGet</span>,
        summary: <span class="type">Summary</span>(<span class="string">"Get</span> \(\.<span class="property">$lessonToGet</span>) <span class="string">details"</span>)) {
          <span class="type">OptionsCollection</span>(<span class="type">LessonEntityQuery</span>(), title: <span class="string">"All Lessons"</span>, systemImageName: <span class="string">"cloud.rainbow.half"</span>)
      }
    )
  }
}
</code></pre><p>So what's going on here?</p><ul><li>First, a static var defines the color of the shortcut tile this app uses in the Shortcuts app.</li><li>Then another static var defines an array of AppShortcut objects. The first argument is the intent to fire when this shortcut is called, followed by phrases Siri can recognize for this shortcut.</li><li>Then a title and image are defined to make this shortcut unique to the users.</li><li>Finally a parameter presentation allows the Shortcut app to present a "fill in the blank" presentation (if there are arguments) for this shortcut, and a list of possible items that can be used to populate the parameter list. This is where the <code>suggestedEntities()</code> method from the last step can come in handy.</li></ul><a name="updatingShortcutParameters"></a>
<h2>Updating Shortcut Parameters</h2><p>Whenever you update the available entities in your app, you need to make sure that you update the shortcuts so they get the latest set of parameters (e.g. the entities in your app). That can easily be done with this call:</p><pre><code>     <span class="type">LessonShortcuts</span>.<span class="call">updateAppShortcutParameters</span>()
</code></pre><p>Where <code>LessonShortcuts</code> is the name of the class that extends <code>AppShortcutsProvider</code> that we defined earlier.</p><a name="tryingYourShortcutInTheShortcutsApp"></a>
<h2>Trying your Shortcut in the Shortcuts App</h2><p>In the shortcuts app, you can use the "+" in the upper right corner to add a new shortcut. Raise up the half-screen window to see the full list of apps that have shortcuts available for use, and select the EP Example app. When you do that the list of available shortcuts will show</p><img src="../../../week11/epExampleAppShortcuts.png#centerResized" alt="Figure 1"/><p>Select "Get details for lesson". A dialog will open up that lets you fill in any parameters for the shortcut (which remember, is driven by an intent). Choose one of the available lessons.</p><img src="../../../week11/epExampleAppShortcuts2.png#centerResized" alt="Figure 2"/><p>Then hit play. The view you created earlier will appear. This happens even though the EP Example app isn't the app in the foreground, which means that shortcut can be run from anywhere, and doesn't interfere with what you are doing. Which will come in handy in the next module.<br><br><img src="../../../week11/epExampleAppShortcuts3.png#centerResized" alt="Figure 3"/></p><p style="float: left">Previous:  <A HREF="../../Week11/00-Week11Overview/index.html">Week 11 Overview</A></p><p style="float: right">Next:  <A HREF="../../Week11/02-UsingAppIntentsWithActionButton/index.html">Using App Intents with Action Button</A></p><BR/><BR/></div><leftside><u><p>Week 11</p></u><div class="weekSection"><ul><li><div class="comment-container"><div class="tocItem"><a id="Week 11 Overview" href="../../Week11/00-Week11Overview/index.html">Week 11 Overview</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Using App Intents with Shortcuts" href="../../Week11/01-UsingAppIntentsWithShortcuts/index.html">Using App Intents with Shortcuts</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Using App Intents with Action Button" href="../../Week11/02-UsingAppIntentsWithActionButton/index.html">Using App Intents with Action Button</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Using App Intents with Siri" href="../../Week11/03-UsingAppIntentsWithSiri/index.html">Using App Intents with Siri</a></div></div></li></ul></div></leftside><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated January 25, 2025 at 8:04 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></div></body></html>