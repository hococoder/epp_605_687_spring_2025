<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week03/03-IntroductionToTheCodableProtocol"/><meta name="twitter:url" content="https://hococoder.com/posts/Week03/03-IntroductionToTheCodableProtocol"/><meta name="og:url" content="https://hococoder.com/posts/Week03/03-IntroductionToTheCodableProtocol"/><title>Week 3 - Introduction to the Codable Protocol | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 3 - Introduction to the Codable Protocol | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 3 - Introduction to the Codable Protocol | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><script src="../../../../jquery-3.7.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><div class="layout"><div class="header"><div class="headerLayout"><div class="title">Mobile Application Development for the iOS Platform</div><div class="subtitle">Engineering Program for Professionals - 605.687 - 2024-2025 Academic Year</div><div class="weeklayout"><a class="grow1" href="/epp_605_687_fall_2024/posts/Intro/About Me">About Me</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Intro/Example App">Example App</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week00/00-Week00Overview">Week 0</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week01/00-Week01Overview">Week 1</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week02/00-Week02Overview">Week 2</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week03/00-Week03Overview">Week 3</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week04/00-Week04Overview">Week 4</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week05/00-Week05Overview">Week 5</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week06/00-Week06Overview">Week 6</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week07/00-Week07Overview">Week 7</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week08/00-Week08Overview">Week 8</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week09/00-Week09Overview">Week 9</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week10/00-Week10Overview">Week 10</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week11/00-Week11Overview">Week 11</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week12/00-Week12Overview">Week 12</a><a class="grow1" href="/epp_605_687_fall_2024/posts/Week13/00-Week13Overview">Week 13</a></div></div></div><div class="wrapper"><h1>Week 3 - Introduction to the <code>Codable</code> Protocol</h1><p style="float: left">Previous:  <A HREF="../../Week03/02-IntroductionToUserDefaults/index.html">Introduction to User Defaults</A></p><p style="float: right">Next:  <A HREF="../../Week03/04-IntroductionToSwiftData/index.html">Introduction to SwiftData</A></p><BR/><BR/><a name="overview"></a>
<h2>Overview</h2><center><iframe src="https://jh.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=d0f013e0-4277-4b15-a93f-b1b90013df7e&autoplay=false&offerviewer=true&showtitle=true&showbrand=true&captions=false&interactivity=all" height="720" width="1280" style="border: 1px solid #464646;" allowfullscreen allow="autoplay" aria-label="Panopto Embedded Video Player" aria-description="Week0-04-THIRDPARTYTOOLS-Lecture" ></iframe></center><div id="floater">
<h3><u>Page Contents</u></h3>
<ul><li><a href="#overview">Overview</a></li><li><a href="#builtInIosEncodersAndDecoders">Built in iOS Encoders and Decoders</a></li><li><a href="#jsonencoderJsondecoder">JSONEncoder/JSONDecoder</a></li></ul></div><p>Introduced in Swift 4, the <code>Codable</code> protocol is actually a composition of 2 protocols - <code>Encodable</code> and <code>Decodable</code>. Classes that adopt this protocol get a lot of built in behavior - the system, behind the scenes, synthesizes methods to help with the encoding and decoding of the data as long as you are using primitives Swift knows about, or if you are using more complex types and have defined how to encode and decode the properties in those types. Let's take a look at an example <code>Student</code> struct that adopts the <code>Codable</code> protocol</p><pre><code><span class="keyword">struct</span> Student: <span class="type">Codable</span> {
  
  <span class="keyword">var</span> studentID: <span class="type">Int</span>
  <span class="keyword">var</span> studentGrade: <span class="type">Double</span>
  
}
</code></pre><p>This is about as bare bones as a struct can get. It has a <code>studentID</code>, which is an <code>Int</code>, and a <code>studentGrade</code>, which is a <code>Double</code>, as properties. Even though I have told the compiler this adopts the <code>Codable</code> protocol, I haven't added anything to the struct to support this. All of that happens behind the scenes. This is a pretty common theme in Swift and SwiftUI - things like Property Wrappers and even some protocol implementations add a layer of syntactical sugar to the language, enabling many features for you.</p><p>Here, I'll initialize an instance of <code>Student</code>, and make a <code>URL</code> on the filesystem so I can store it later. We'll use the <code>URL.documentsDirectory</code> we learned about earlier to get a handle to the documents directory, and build the <code>fileURL</code> from it.</p><pre><code><span class="keyword">let</span> student = <span class="type">Student</span>(studentID: <span class="number">5490</span>, studentGrade: <span class="number">93.0</span>)

<span class="keyword">let</span> documentsDirectory = <span class="type">URL</span>.<span class="property">documentsDirectory</span>
<span class="keyword">let</span> filePath = <span class="string">"</span>\(documentsDirectory.<span class="property">path</span>)<span class="string">/student.plist"</span>
<span class="keyword">let</span> fileURL = <span class="type">URL</span>(fileURLWithPath: filePath)
</code></pre><p>Just a reminder: these URL APIs are vital to get the proper directory under your App - for example, for me, the above file is located at "file:///Users/teacher/Library/Developer/XCPGDevices/1A0A559F-1B35-4AF2-A914-9064CDC44DA7/data/Containers/Data/Application/1F173459-59C8-4E52-9A0B-BE2C6324589A/Documents/student.plist" - which is way too hard to remember (much less find in Finder)!</p><p>The pair of classes that helps us encode and decode that data into something that is suitable for file storage is <code>NSKeyedArchiver</code> - which handles the encoding - and <code>NSKeyedUnarchiver</code> - which handles the decoding. These classes however, act on something that adopts <code>NSCoding</code> not, <code>Codable</code>, like our struct. But there are other classes that can help us get our data into the proper format for <code>NSKeyedArchiver</code> and <code>NSKeyedUnarchiver</code>.</p><a name="builtInIosEncodersAndDecoders"></a>
<h2>Built in iOS Encoders and Decoders</h2><p>Objects that adopt <code>Codable</code> can easily be processed by many of Swift's classes such as <code>PropertyListEncoder</code>, to get them into a format that <code>NSKeyedArchiver</code> and <code>NSKeyedArchiver</code> can understand. Let’s make one of those now, and then encode our <code>student</code> object using that encoder. We can then save and load it just like the example from earlier, but at the end don’t forget to use the <code>PropertyListDecoder</code> to get the data converted from the property list back to the <code>Student</code> object.</p><pre><code><span class="keyword">do</span> {
  <span class="keyword">let</span> studentEncoded = <span class="keyword">try</span> <span class="type">PropertyListEncoder</span>().<span class="call">encode</span>(student)
  <span class="keyword">if let</span> data = <span class="keyword">try</span>? <span class="type">NSKeyedArchiver</span>.<span class="call">archivedData</span>(withRootObject: studentEncoded, requiringSecureCoding: <span class="keyword">false</span>)
  {
    <span class="keyword">try</span>? data.<span class="call">write</span>(to: fileURL)
    
    <span class="comment">//read it back in - we'll use this deprecated method for now since we are dealing with Codable here, not NSCoding</span>
    <span class="keyword">let</span> studentEncoded2 = <span class="keyword">try</span> <span class="type">NSKeyedUnarchiver</span>.<span class="call">unarchiveTopLevelObjectWithData</span>(data) <span class="keyword">as</span>! <span class="type">Data</span>
    <span class="keyword">let</span> studentFromDecoder = <span class="keyword">try</span> <span class="type">PropertyListDecoder</span>().<span class="call">decode</span>(<span class="type">Student</span>.<span class="keyword">self</span>, from: studentEncoded2)
    <span class="call">print</span>(<span class="string">"Recovered student ID is</span> \(studentFromDecoder.<span class="property">studentID</span>)<span class="string">"</span>)
  }
</code></pre><p>It's an extra step, but it's simple. There is a way to support <code>CodingKeys</code> in your structs to support <code>NSKeyedArchiver</code> and <code>NSKeyedArchiver</code> directly, but we won't address them here.</p><a name="codeJsonencoderCodeCodeJsondecoderCode"></a>
<h2><code>JSONEncoder</code>/<code>JSONDecoder</code></h2><p><code>Codable</code> objects can also be passed directly into other encoders such as the <code>JSONEncoder</code>. If I pass our <code>student</code> object into that encoder, I can take the result of that, pass it into a <code>String</code> constructor, and see the JSON representation of the object.</p><pre><code>  <span class="keyword">let</span> encoder = <span class="type">JSONEncoder</span>()
  <span class="keyword">let</span> studentAsJSONData = <span class="keyword">try</span>! encoder.<span class="call">encode</span>(student)

  <span class="keyword">let</span> studentAsJSONString = <span class="type">String</span>(data: studentAsJSONData, encoding: .<span class="dotAccess">utf8</span>)!
  <span class="call">print</span>(<span class="string">"Student as JSON string is</span> \(studentAsJSONString)<span class="string">"</span>)

} <span class="keyword">catch</span> {
  <span class="call">print</span>(<span class="string">"Problem encoding or decoding</span> \(error)<span class="string">"</span>)
}
</code></pre><p>This produces:</p><pre><code><span class="type">Student</span> <span class="keyword">as</span> <span class="type">JSON</span> string <span class="keyword">is</span> {<span class="string">"studentGrade"</span>:<span class="number">93</span>,<span class="string">"studentID"</span>:<span class="number">5490</span>}
</code></pre><p>Once you start getting more advanced data types, for many of them, tracking items on the filesystem becomes inefficient. Luckily, iOS has two database frameworks, one called SwiftData, and another called CoreData that helps take your data management to the next level. Let's talk about Swift Data first.</p><p style="float: left">Previous:  <A HREF="../../Week03/02-IntroductionToUserDefaults/index.html">Introduction to User Defaults</A></p><p style="float: right">Next:  <A HREF="../../Week03/04-IntroductionToSwiftData/index.html">Introduction to SwiftData</A></p><BR/><BR/></div><leftside><u><p>Week 3</p></u><div class="weekSection"><ul><li><div class="comment-container"><div class="tocItem"><a id="Week 3 Overview" href="../../Week03/00-Week3Overview/index.html">Week 3 Overview</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Your Apps Directory Structure" href="../../Week03/01-YourAppsDirectoryStructure/index.html">Your Apps Directory Structure</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to User Defaults" href="../../Week03/02-IntroductionToUserDefaults/index.html">Introduction to User Defaults</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to the Codable Protocol" href="../../Week03/03-IntroductionToTheCodableProtocol/index.html">Introduction to the Codable Protocol</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to SwiftData" href="../../Week03/04-IntroductionToSwiftData/index.html">Introduction to SwiftData</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Introduction to CoreData" href="../../Week03/05-IntroductionToCoreData/index.html">Introduction to CoreData</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Setting up a Schema" href="../../Week03/06-SettingUpASchema/index.html">Setting up a Schema</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="NSManagedObjects" href="../../Week03/07-NSManagedObjects/index.html">NSManagedObjects</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Storing and Fetching" href="../../Week03/08-StoringAndFetching/index.html">Storing and Fetching</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Populating the Database" href="../../Week03/09-PopulatingTheDatabase/index.html">Populating the Database</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="SwiftUI Improvements" href="../../Week03/10-SwiftUIImprovements/index.html">SwiftUI Improvements</a></div><div class="chain chain-bottom"></div></div></li><li><div class="comment-container"><div class="chain chain-top"></div><div class="tocItem"><a id="Converting to SwiftData" href="../../Week03/11-ConvertingToSwiftData/index.html">Converting to SwiftData</a></div></div></li></ul></div></leftside><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated January 23, 2025 at 6:01 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></div></body></html>